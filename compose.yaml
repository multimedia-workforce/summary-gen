services:
  worker:
    build:
      context: .
      dockerfile: ./dockerfiles/worker.Dockerfile
    ports:
      - 443:443
      - 50051:50051
    environment:
      - GRPC_LISTEN_ADDRESS=0.0.0.0:50051
      - OPENAI_ENDPOINT=https://engelbert.ip-ddns.com
      - OPENAI_TOKEN=qhps7UQwMVG9zhxzq2vzHYR1YiDWd6xRptf729y16BfZ5WSmUO8mrb1lwFtQR6dr
      - SPDLOG_DEBUG=true

  frontend:
    build:
      context: .
      dockerfile: ./dockerfiles/frontend.Dockerfile
    ports:
      - 8080:3000
    depends_on:
      - worker
    environment:
      - GRPC_HEARTBEAT_INTERVAL=10000
      - GRPC_LISTEN_ADDRESS=worker:50051
      - BODY_SIZE_LIMIT=Infinity
